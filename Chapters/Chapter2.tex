% Chapter Template

\chapter{GNSS Systems Overview} % Main chapter title

\label{Chapter2} % Change X to a consecutive number; for referencing this chapter elsewhere, use \ref{ChapterX}

%----------------------------------------------------------------------------------------
%	SECTION 1
%----------------------------------------------------------------------------------------

\section{History of GNSS Systems} \label{sec:GNSSHistory}
In 2021 there are many different GNSS systems that are in place that service the globe. It is a technology that has become deeply ingrained in the everyday lives of most
people around the world. The first digital based navigation system similar to what we know today was the use of terrestrial based radio transmitters. The concept was
similar to that of the current satellite based systems, namely the use of psuedoranges, although the accuracy was far lower than is acceptable today. The USA developed and commissioned the first
satellite based nanvigation system.

As of 2021 there are six operational GNSS systems in use. These are GPS (USA), GLONASS (Russia), Galileo (EU), BeiDou (China), IRNSS/NavIC (India) and QZSS (Japan). The QZSS
system currently acts to complement the coverage of GPS in the East Asian and Oceanic regions with 4 operational satellites. There are plans to increase this number of
satellites to allow for stand alone use as a GNSS provider \cite{RN47}. The Indian IRNSS similarly provides regional covereage around India with 8 satellites in
geostationary orbit \cite{RN55} . There are three categories of orbit, LEO, MEO and GEO. These are so categorised by how far from the earths surface the satellite orbits. Current GNSS
systems utelise MEO orbits.

GNSS, and more specifically GPS and GLONASS, date back to 1957 during the space race between the USA and the then USSR \cite{RN43}. When Russian satellite Sputnik 1 was launched scientists at the John Hopkins University were able to track its position and velocity by measuring the doppler shift of the
craft. This tracking from Doppler shift measurements contniued with the launch of the subsequent satellites Sputnik 2 and Explorer 1. After this it was thought that the
process could be reversed such that a satellite with a known position could be used to resolve an unknown position on earth. In the 1960's the TRANSIT satellite
navigation system was made operational for US Navy use, mainly for postion and navigation of nuclear ballistic missile submarines. TRANSIT received strong support due to
the accuracy of up to 80ft (24m) which was a significant improvement over existing VLF (Very Low Frequency) hyperbolic navigation systems. After 32 years of operation the
system was retired in 1996 after proving that space crafts could be reliable \cite{RN45}. 

In 1973 the US combined two existing programmes in TIMATION and 'Project 621B' to form the 'NAVSTAR Global Positioning System' which would later become known more
commonly as GPS. The initial intention for the use of GPS was for military only. However, in 1983 there was an incident that saw a Korean Airlines flight shot down by a
Soviet fighter mistaking it for a US aircraft when it wandered off course. After this incident President Reagen announced that GPS would be made available for civilian
use. The military insisted that the accuracy of the system be purposley degraded for civilian use though selective availabililty such that GPS could not be used by
adversaries. In 1993 the system was declared operational. To combat the intentional accuracy reduction of the GPS system augmentation systems started to appear. Soon
after there were Government funded versions of DGPS (Differetial GPS) systems \cite{RN43}. Augmentation systems significantly increases the accuracy by using a receiver with a known
location and having that reciever calculate its position from the satellite signals and compare with the known position. These corrections are then broadcast. 

The Soviet Union launched their first GLONASS satellite in 1982, and in the following three years 10 more were launched. There are some technical differences between the
GLONASS and GPS constellations. The orbital planes are different and GLONASS uses an FDMA (Frequency Division Multiple Access) scheme as opposed to the GPS's CDMA (Code
Division Multiple Access). In 1993 president Yeltsin declared that the GLONASS constllation was fully operational, however this was not the case. 

The TRANSIT satellite system orbit was in a LEO (Low Earth Orbit) polar orbit, whereas all modern GNSS systems utelise a MEO (medium earth orbit) ranging from 20,000km to
23,000km above the earths surface with multiple orbital planes. The number of planes differs between the different constellations as discussed below.
The lower the orbit, the higher the velocity requried to maintain the orbit as shown by the orbital mechanics equation \ref{eq:orbitalVelocity}. Equally a higher orbit requires a lower velocity which
has impact on the doppler shift at the receivers. Another factor is aerodynamic drag, which is higher the closer to the earths surface due to the atmosphere.

\begin{equation} \label{eq:orbitalVelocity}
    v \approx \frac{2\pi a}{T} \approx \sqrt{\frac{\mu_{earth}}{a}}
\end{equation} 

The history of the two other main GNSS systems is much shorter, with the Galileo constellation coming as a form of sovereignty for the European Union. The fist sattelite
was launched in 2011, and the service became operational in 2016. There is also a network of GPS augmnetation sites that provide improved accuracy for those in the EU.
This system is named EGNOS. This system provided an average of 1.5m accuracy over the EU territory. This was provided through the use of ground stations and a
geostationary satellite broadcasting the timing corrections. 

%----------------------------------------------------------------------------------------
%	SECTION 2
%----------------------------------------------------------------------------------------

\section{GNSS Systems} \label{sec:GNSS}
\subsection{Introduction to GNSS Constellations}\label{subsec:GNSS_Intro}
GNSS is a term used to describe any satllelite system that provides positon and timing information. All GNSS systems in use today have three sepearte segements that
encompass the term GNSS. That is the ground segment, space segment and user segment. These are used in conjunction to allow the user to calculate with accuracy up to $\pm
10cm$. In order to calculate an unknown poistion on earth, the exact position of the orbiting satellite must be known. The satellite will send it's exact position as well
as it's current time down to the earths surface. It's location, or ephemeris, can be tracked due to Kepler's laws and celestial mechanics. The time on board satellites is
kept via the use of caesium based atomic clocks. The GPS clocks are accurate to approximatly 10 nanoseconds \todo{reference}, however, receviers will lose timing due to
the interpretation of signals and typically provide accuracy of 100 nanoseconds. The value of the clocks are constantly monitoed by the ground segment and updated when
required. Part of the Receviers (the user segment) will pick up this signal. The components of the message sent are quite simple and consist
mostly of the current time (of the satellite) and where the sattelite is in the WGS-84 coordinate system\cite{RN46}. This coordinate system has its origin at the centre of mass of
the earth with the Z axis pointing at the north pole, the X axis pointing towards the prime meridian and the y axis perpendicular to both other axes. Due to the reletive
motion of the satllite and the reciever the transmitted signal will be shifted up or down the frequency range due to the doppler effect. The combination of this doppler
shift, time taken to arrive and the satellite current location can be used to solve the postiion in three dimensional space. In order to solve for all dimensions
(including time) four satellites are reqruied since there are essentially 4 unknown terms to solve for as shown in equation \ref{eq:gnssPosition} \cite{RN46}. The
$\rho_i$ term indicates the distance from the recviever to that particular satellite. This method of position calculation is known as trilateration. The model shown below
is a simplified model that ignores the effects of relativity. 

\begin{equation} \label{eq:gnssPosition} 
    \rho_i = \sqrt{(x_i - x_u)^2 + (y_i - y_u)^2 + (z_i - z_u)^2} + c \Delta t
\end{equation}
\todo{look at RN32 for position and time calculations}
As can be seen from the above equation \ref{eq:gnssPosition} the accurate synchronisation of time betweeen the receiver and the satellites is required in order to
calcaulte an accurate position. Due to the mathmatical requirements, a minimum of 4 satellites need to be in 'sight' of the receiver at all times.

Each of the operational constellations use the same fundamentals to provide accurate postion data, but each differ in some key aspects as discussed below.

\subsection{Kepler's Laws of Planetary Motion} \label{subsec: OrbitalMechanics}
In the 1600's German astronomer Johannes Kepler described the orbits of the solar systems planets around the sun using three laws. 
These laws famously moved our understanding of orbits away from circles and described them as ellipses. The position of modern day satellites need to be accurtatly
predicated and as such these laws have become important to the way we live our lives. Kepler's laws are as follows; First law states that the orbit of every planet is an
elllipse with the sun at the one of the two foci. Second law states that a line joining the planet to the sun will sweep out equal area during equal intervals of time.
The third law states that the ratio of the orbital period with the cube of the semi-major axis is the same for all objects orbiting the same primary. These laws can be
adapted to objects that orbit other objects other than the sun. Examples are moons orbiting plantes and artifical satellites orbiting the earth.

\subsection{GPS} \label{subsec:GNSS_GPSIntro}
The GPS constellation consists of a nominal 24 satelelites in 6 orbital planes (nominally 4 satellites per plane) to ensure that there is coverage globally at all times.
There are also some spare satellites that are in orbit in the event that a operational satellite malfunctions.
The constellation orbits at an altitude of 20,200km which equates to an orbital period of 12hours.
There are multiple frequencies of differeing propoerties that each satellite will transmit at. For GPS these are named the L1, L2 and L5 bands and have centre frequencies
of 1575.42MHz, 1227.60MHz and 1176.45MHz respectively \cite{RN49}. This is shown graphically in Figure \ref{fig:SignalPlan}. The L1 band is the most commonly used and was the first one to be made operational. In the past the L1
band was used for civilian purposes and the L2 band was a military band. Nowadays both have active cilivilan and encrypted signals co-exiting within their respective
frequncy bands. GPS predominately uses BPSK but also utelises BOC for signal modulation accross all of the bands.  

Initially the civilian C/A code was purposley degraded to ensure that adversaries of the USA could not use the system to its maximum effect. In May 2000 President Bill
Clinton directed the removal of selective availabililty from the GPS service, and in 2007 it was announced that the newest version of GPS satellites would be manufactured
without the selective availabililty capapbility.
\todo{expand, reference}

GPS hardware has had a number of revisions over the life of the system in the form of Blocks. Each block is a major revision, current generation satellites are Block III
satellites. There are currenntly 4 block III satellites in service with 6 more planned for launch. There are 12 block IIF satellites in operation which were launched from
2010 to 2016. Block IIR has 8 currently operational from 13 launches, block IIR-M has 7 operational from 8 launches and there are no operational satellites from Block I,
II or IIA. This totals 31 opeartional satellites, 24 in opeartion and 7 spares as summarised in Table \ref{tab:GPSSatSum}

Accuracy of the GPS system has increased over the years, and since selective availabililty was legislated against, to approximatly 3m for public access and 3-4cm for encrypoted.

\renewcommand{\arraystretch}{1.5}
\begin{table}
    \begin{center}
        \caption{Summary of current and former GPS satellites}
        \label{tab:GPSSatSum}
        \begin{tabular}{ |r|c|c| }
            \hline
            \textbf{Block} & \textbf{Launched} & \textbf{In Service} \\
            \hline
            Block I & 11 & 0\\
            \hline
            Block II & 9 & 0\\
            \hline
            Block IIA & 19 & 0\\
            \hline
            Block IIR & 13 & 8\\
            \hline
            Block IIR-M & 8 & 7\\
            \hline
            Block IIF & 12 & 12\\
            \hline
            Block III & 4 & 4\\
            \hline
            \hline
            \textbf{Total} & \textbf{76} & \textbf{31}\\
            \hline
        \end{tabular}
    \end{center}
\end{table}
\renewcommand{\arraystretch}{1}

\subsection{Galileo} \label{subsec:GNSS_GalileoIntro}
The Galileo constellation is a GNSS created by the ESA (European Space Agency) and opeated by the EGA (European GNSS Agency) as a way of providing a modern navigation
system that has global covereage. The Galileo constellation has 30 nominal satellites accross 3 orbital planes. The first Galileo satellite was launched in 2011.
The orbit height of the Galileo constellation is higher than the GPS orbit at 23,222 km. 

Galileo operates on 3 different frequency bands, E1, E5 and E6. E1 shares the same centre frequency as the GPS L1 band, 1575.42 MHz. The E6 band does not share a frequncy
with the GPS ssytem and operates at 1278.75 MHz. The E5 band is split into E5a and E5b sub-bands with E5a sharing the same freqeuency as L5, 1176.45 MHz, and E5b at
1207.14 MHz. The arrangmeent of the frequency bands can be seen in Figure \ref{fig:SignalPlan}.

\begin{figure}[h]
    \begin{centering}
        \includegraphics[width=14cm,height=10cm,keepaspectratio]{Figures/Galileo_Frequency_Plan.png}
        \caption{Galileo and GPS signal frequency arrangement}
        \label{fig:SignalPlan}
    \end{centering}
\end{figure}

To maintain interoperability between receivers on the L1 and E1 bands the modulation scemes differ.
The E1 band utileses Composite BOC modulation, E6 uetelises BPSK, and the E5 bands utelise Alternative BOC modulation.
Galileo offers superior accuracy than the other constellations with 1m for the public access and 1cm for encrypted service. 

\subsection{GLONASS} \label{subsec:GNSS_GLONASSIntro}
The Russian GLONASS constellation has it's hsitory tightly intertwined with that of GPS and the space race, as mentioned above in \ref{sec:GNSSHistory}.
GLONASS consits of a nominal 24 satellites in 3 orbital planes. Since GLONASS uses FDMA, each satellite needs to transmit on a unique frequency. This is in contrast to
all other GNSS systems that use CDMA. There are three freqeuency bands that GLONASS operates in, L1, L2 and L3. These are seperate to the L1, L2 of GPS. 

GLONASS L1 band is from 1598.0625 MHz to 1605.375 MHz split into 14 channels. Each carrier is 562.5 kHz apart and is characterised by equation \ref{eq:GLONASS Channel
calc}. $k$ represents the channel number of the band and ranges from -7 to +6. 

The L2 band ranges from 1242.9375 MHz to 1248.625 MHz with each carrier separated by 437.5 kHz.

The L3 band ranges from 1197.9375 MHz to 1203.625 MHz with the same carrier sepeartion as L2.

\begin{equation} 
    \begin{split} \label{eq:GLONASS Channel calc}
        f_{k_{L1}} = f_{0_{L1}} + k \Delta f_{L1} \\ 
        f_{k_{L2}} = f_{0_{L2}} + k \Delta f_{L2} \\ 
        f_{k_{L3}} = f_{0_{L3}} + k \Delta f_{L3}
    \end{split}
\end{equation}

\subsection{BeiDou} \label{subsec:GNSS_BeiDouIntro}
From the BeiDou official website it states that "BeiDou has been constructed and operated by China with an eye on the needs of the country's national sceurity, economic
and social development".

This is China's attempt at creating a sovreign navigation constellation.

\subsection{Augmentation Systems} \label{subsec:GNSS_OtherIntro}
As mentinoned above there are two other GNSS constellations that act to improve availabililty and accuracy in regional areas. These are the Japanese QZSS and Indian
IRNSS. Both of these extend the abilities of the USA GPS system. The 4 satellites that are operational for the QZSS constellation are able to transmit on the L1 and L5
band  simultaneously. Doing so helps to resolve ionospheric errors by facilitating resolution of position from multiple frequencies \cite{RN48}.

The IRNSS constellation is different to the others mentioned above due to its orbit altitude of 36,000km making them geostation. All of the satellites are postiioned at
this orbit. This allows for a very narrow and defined region of useability, which is over India. 

Other forms of augmentation as mentioned in Section \ref{sec:GNSSHistory} were through ground based stations that use receivers to determine the timing error and broadcast these
values in order to make the solution to the positon cacluation more accurate. This type of system allows for sub 1m accuracy. These systems are typically rolled out
geographically locally and run by those local Governments.

\subsection{GNSS Receivers}
Traditional GNSS receivers are specialised hardware components that are able to receive the spread spectrum signal from the GNSS satellite and perform the required
calculations to acquire the PVT data. This data is then provided serially to a main processor of the system in the form of NMEA sentences. There are many sentence types
and not all receivers will output all sentence types. 

%----------------------------------------------------------------------------------------
%	SECTION 3
%----------------------------------------------------------------------------------------

\section{Applications of GNSS} \label{sec:ApplicationsGNSS}
GNSS applications are broad and deeply ingradined in the almost everyones everyday lives. These applications vary from providing postion and navigation information for
maps on a smartphone or sat-nav devce to providing accurtate timing infomation for financial institutions \cite{RN33}.

%----------------------------------------------------------------------------------------
%	SECTION 4
%----------------------------------------------------------------------------------------

\section{Spoofing Overview}
Attacks on the GNSS archtiecture can broadly be divided into two categories jamming and spoofing \cite{RN33} \cite{RN32}. Jamming can be described as causing intentional
interference in the communicationn channel as to make the recovery of signal informaiton impossible. A successful jamming attack will make it impossibe to begin tracking
satellites and thus be unable to calculate any of the PVT data. This differs from spoofing attacks where the main interest is to deceive any reciever that picks ups the
signal into thinking it is elsewhere or else-when. This is done by different methods and stems from which property of the signal is being modified for the attack. A
successful spoofing attack will have the receiver 'tracking' the signal produced by the spoofer and the receiver will not be aware that an attack is taking place. Common
spoofing attacks are explained below.

\subsection{Meaconing}
Meaconing is a type of GNSS spoofing attack that involves recording a legitimate GNSS signal and re-broadcasting. This could be either instantly or at a different time or
place. This requries little prior knowledge of the GNSS system that the attacker wishes to record other when used with existing open source software packages. Although
there is a requirenment of having the right equipment to be able to capture the raw analog signal.

\subsection{Signal Generation}
There are software packages and off the shelf hardware that are designed for testing GNSS receivers in a laboratory setting. These can be used to generate a that can be
played in such a manner as to perform a spoofing attack. This differes from meaconing because knowledge of the satellite ephemeris and almanac is required. The almanac is
a record of the rough location of all satellites in a constellation and the ephemeris is the exact location of each individual satellite. This knowledge is requied as to
produce the same results as recording the gps signal from the desired location.

%----------------------------------------------------------------------------------------
%	SECTION 5
%----------------------------------------------------------------------------------------

\section{SDR Basics}
Software defined radios are devices that enable the user to increase the flexibility of transmissionn and reception of RF signals by moving processing typically reserved
for the analog domain into the digital domain. Thus SDR's move the signal processing from rigid and expensive hardware into flexible and in-expensive software. This
allows for a wide ranges of frequncies from Hz up to GHz from the same device with minor or no hardware changes. This can also be done in real time using software.
SDR's are very sensitive to the processing power of the copmuter that they are connected to. It is not uncommon to receive an underrun error (where 'U' is printed to the
output) when transmitting a signal with high sps (samples per second). This error is caused by the host computer not being able to feed the data to the radio quickly
enough.

This was solved by increasing the UDP buffer size manually to at least the sample rate. From limited experimentation this completely resolved the issue, and opened up
oppertunities to perform spoofing with low powered embedded devices like the Rasperry Pi single board computer. \todo{move this sentence to results}